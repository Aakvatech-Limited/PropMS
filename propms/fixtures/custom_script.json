[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Security Attendance Details", 
  "modified": "2018-12-25 14:32:13.914746", 
  "name": "Security Attendance Details-Client", 
  "script": "cur_frm.set_query(\"guard_empid\", function() {\n    return {\n        \"filters\": {\n            \"department\": [\"like\", \"Security - \"]\n        }\n    }\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Issue", 
  "modified": "2018-12-27 17:16:50.361484", 
  "name": "Issue-Client", 
  "script": "cur_frm.add_fetch('person_in_charge', 'employee_name', 'person_in_charge_name');\ncur_frm.set_query(\"person_in_charge\", function() {\n    return {\n        \"filters\": {\n            \"department\": [\"like\", \"Maintenance - %\"]\n        }\n    }\n});\ncur_frm.add_fetch('sub_contractor_contact', 'supplier_name', 'sub_contractor_name');\ncur_frm.set_query(\"sub_contractor_contact\", function() {\n    return {\n        filters: {\n            'supplier_group': 'Sub-Contractor'\n        }\n    }\n});\ncur_frm.fields_dict['materials_required'].grid.get_field('material_request').get_query = function(doc, cdt, cdn) {\n    var child = locals[cdt][cdn]\n    return {\n        filters: [\n            ['Material Request', 'docstatus', '=', '0'],\n            ['Material Request', 'docstatus', '=', '1']\n        ]\n    }\n}\nfrappe.ui.form.on('Issue Materials Detail', {\n    material_request: function(frm, cdt, cdn) {\n        var material = locals[cdt][cdn];\n        if (material.material_request) {\n            frappe.call({\n                \"method\": \"frappe.client.get_value\",\n                \"args\": {\n                    doctype: \"Material Request\",\n                    filters: {\n                        \"name\": material.material_request\n                    },\n                    fieldname: \"status\"\n                },\n                callback: function(r) {\n                    frappe.model.set_value(cdt, cdn, \"material_status\", r.message.status);\n                }\n            });\n        }\n    }\n})\nfrappe.ui.form.on('Issue', {\n    property_name: function(frm, cdt, cdn) {\n        frappe.model.set_value(cdt, cdn, \"customer\", \"\");\n\tif (frm.doc.property_name) {\n            frappe.call({\n                method: \"frappe.client.get_value\",\n                args: {\n                    doctype: \"Property\",\n                    fieldname: \"status\",\n                    filters: {\n                        name: frm.doc.property_name\n                    },\n                },\n                callback: function(r, rt) {\n                    if (r.message) {\n                        if (r.message.status == \"On lease\") {\n                            frappe.call({\n                                method: \"frappe.client.get_value\",\n                                args: {\n                                    doctype: \"Lease\",\n                                    fieldname: \"customer\",\n                                    filters: {\n                                        property: frm.doc.property_name\n                                    },\n                                },\n                                callback: function(r, rt) {\n                                    if (r.message) {\n                                        frappe.model.set_value(cdt, cdn, \"customer\", r.message.customer);\n                                    }\n                                }\n                            });\n                        }\n                    }\n                }\n            });\n        } else {\n            frappe.model.set_value(cdt, cdn, \"customer\", \"\");\n        }\n    }\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Daily Checklist", 
  "modified": "2018-12-25 14:31:54.287234", 
  "name": "Daily Checklist-Client", 
  "script": "frappe.ui.form.on('Daily Checklist', 'area', function(frm, cdt, cdn) {\n    var doc = locals[cdt][cdn];\n    if (doc.area) {\n        frappe.call({\n            method: \"frappe.client.get\",\n            args: {\n                name: doc.area,\n                doctype: \"Checklist Checkup Area\"\n            },\n            callback(r) {\n                console.log(r);\n                if (r.message) {\n                    for (var row in r.message.task) {\n                        var child = frm.add_child(\"daily_checklist_detail\");\n                        frappe.model.set_value(child.doctype, child.name, \"checklist_task\", r.message.task[row].task_name);\n                        refresh_field(\"daily_checklist_detail\");\n                    }\n                }\n            }\n        })\n    }\n})\ncur_frm.fields_dict['daily_checklist_detail'].grid.get_field('job_card').get_query = function(doc, cdt, cdn) {\n    var child = locals[cdt][cdn]\n    return {\n        filters: [\n            ['Issue', 'docstatus', '=', '0'],\n            ['Issue', 'docstatus', '=', '1']\n        ]\n    }\n};", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Key Set Detail", 
  "modified": "2019-01-16 17:42:09.382828", 
  "name": "Key Set Detail-Client", 
  "script": "frappe.ui.form.on(\"Key Set Detail\", \"returned\", function(frm) {\n    if (cur_frm.doc.returned) {\n\tcur_frm.set_value(\"return_date_and_time\", frappe.datetime.now_datetime());\n\tcur_frm.set_df_property(\"returned\", \"read_only\", 1);\n    } else {\n        cur_frm.set_value(\"return_date_and_time\", \"\");\n    }\n});\n\nfrappe.ui.form.on(\"Key Set Detail\",\"onload\",function(){\n\tif (cur_frm.doc.returned) {\n\t\tcur_frm.set_df_property(\"returned\", \"read_only\", 1);\n\t}\n});\n\ncur_frm.set_query(\"key_set\", function() {\n    return {\n        filters: {\n            'status': 'In'\n        }\n    }\n});\n\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Security Attendance", 
  "modified": "2018-12-27 17:05:51.251839", 
  "name": "Security Attendance-Client", 
  "script": "cur_frm.add_fetch('guard_empid', 'employee_name', 'guard_name');\nfrappe.ui.form.on('Security Attendance', 'shift_name', function(frm, cdt, cdn) {\n    var doc = locals[cdt][cdn];\n    if (doc.shift_name) {\n        frappe.call({\n            method: \"frappe.client.get\",\n            args: {\n                name: doc.shift_name,\n                doctype: \"Guard Shift\"\n            },\n            callback(r) {\n                console.log(r);\n                if (r.message) {\n                    for (var row in r.message.shift_location) {\n                        var child = frm.add_child(\"attendance_details\");\n                        frappe.model.set_value(child.doctype, child.name, \"position\", r.message.shift_location[row].location_name);\n                        refresh_field(\"attendance_details\");\n                    }\n                }\n            }\n        })\n    }\n})\ncur_frm.fields_dict['attendance_details'].grid.get_field('guard_empid').get_query = function(doc, cdt, cdn) {\n    var child = locals[cdt][cdn]\n    return {\n        filters: [\n            ['Employee', 'department', 'like', 'Security -%']\n        ]\n    }\n};", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Outsourcing Attendance", 
  "modified": "2019-01-16 17:27:14.888569", 
  "name": "Outsourcing Attendance-Client", 
  "script": "cur_frm.add_fetch('shift_name', 'outsourcing_category', 'outsourcing_category_name');\n\nfrappe.ui.form.on('Outsourcing Attendance', 'shift_name', function(frm, cdt, cdn) {\n    var doc = locals[cdt][cdn];\n    if (doc.shift_name) {\n        frappe.call({\n            method: \"frappe.client.get\",\n            args: {\n                name: doc.shift_name,\n                doctype: \"Outsourcing Shift\"\n            },\n            callback(r) {\n                console.log(r);\n                if (r.message) {\n                    for (var row in r.message.shift_location) {\n                        var child = frm.add_child(\"attendance_details\");\n                        frappe.model.set_value(child.doctype, child.name, \"position\", r.message.shift_location[row].location_name);\n                        refresh_field(\"attendance_details\");\n                    }\n                }\n            }\n        })\n    }\n});\n\ncur_frm.fields_dict['attendance_details'].grid.get_field('person_name').get_query = function(doc, cdt, cdn) {\n    var child = locals[cdt][cdn];\n    return {\n        filters: [\n            ['Outsource Contact', 'parent', '=', cur_frm.doc.outsourcing_category_name ],\n            ['Outsource Contact', 'status', '=', 'Active' ]\n        ]\n    }\n};\n\nfrappe.ui.form.on('Outsourcing Attendance Details', {\n\tperson_name:function(frm,cdt,cdn){\n\t\tvar row=locals[cdt][cdn];\n\t\tvar doc=locals['Outsourcing Attendance'][row.parent];\n\t\tfor(var item in doc.attendance_details){\n\t\t\tif(doc.attendance_details[item].person_name==row.person_name){\n\t\t\t\tif(doc.attendance_details[item].name!=row.name){\n\t\t\t\t\tfrappe.model.set_value(cdt,cdn,\"person_name\",\"\");\n\t\t\t\t\tfrappe.throw(\"Person already selected, please select a different person.\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Invoice", 
  "modified": "2019-01-07 12:21:29.162252", 
  "name": "Sales Invoice-Client", 
  "script": "frappe.ui.form.on('Sales Invoice', {\n    property_name: function(frm, cdt, cdn) {\n        frappe.model.set_value(cdt, cdn, \"customer\", \"\");\n\tif (frm.doc.cost_center) {\n            frappe.call({\n                method: \"frappe.client.get_value\",\n                args: {\n                    doctype: \"Property\",\n                    fieldname: \"status\",\n                    filters: {\n                        name: frm.doc.cost_center\n                    },\n                },\n                callback: function(r, rt) {\n                    if (r.message) {\n                        if (r.message.status == \"On lease\") {\n                            frappe.call({\n                                method: \"frappe.client.get_value\",\n                                args: {\n                                    doctype: \"Lease\",\n                                    fieldname: \"customer\",\n                                    filters: {\n                                        property: frm.doc.cost_center\n                                    },\n                                },\n                                callback: function(r, rt) {\n                                    if (r.message) {\n                                        frappe.model.set_value(cdt, cdn, \"customer\", r.message.customer);\n                                    }\n                                }\n                            });\n                        }\n                    }\n                }\n            });\n        } else {\n            frappe.model.set_value(cdt, cdn, \"customer\", \"\");\n        }\n    }\n})", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Journal Entry Account", 
  "modified": "2019-01-07 12:21:16.799713", 
  "name": "Journal Entry Account-Client", 
  "script": "frappe.ui.form.on('Journal Entry Account', {\n    property_name: function(frm, cdt, cdn) {\n        frappe.model.set_value(cdt, cdn, \"party\", \"\");\n\tif (frm.doc.cost_center) {\n            frappe.call({\n                method: \"frappe.client.get_value\",\n                args: {\n                    doctype: \"Property\",\n                    fieldname: \"status\",\n                    filters: {\n                        name: frm.doc.cost_center\n                    },\n                },\n                callback: function(r, rt) {\n                    if (r.message) {\n                        if (r.message.status == \"On lease\") {\n                            frappe.call({\n                                method: \"frappe.client.get_value\",\n                                args: {\n                                    doctype: \"Lease\",\n                                    fieldname: \"customer\",\n                                    filters: {\n                                        property: frm.doc.cost_center\n                                    },\n                                },\n                                callback: function(r, rt) {\n                                    if (r.message) {\n                                        frappe.model.set_value(cdt, cdn, \"party\", r.message.customer);\n                                    }\n                                }\n                            });\n                        }\n                    }\n                }\n            });\n        } else {\n            frappe.model.set_value(cdt, cdn, \"party\", \"\");\n        }\n    }\n})", 
  "script_type": "Client"
 }
]